---
import PagePlate from "@/layouts/PagePlate.astro";
---

<PagePlate title="Chat Rooms">
	<div class="max-w-2xl mx-auto p-8">
		<h1 class="text-4xl font-bold mb-8">Chat Rooms</h1>

		<!-- Create New Room -->
		<div class="bg-white rounded-lg shadow-md p-6 mb-6">
			<h2 class="text-2xl font-semibold mb-4">Create a New Room</h2>
			<button
				id="createRoom"
				class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition"
			>
				Create Room
			</button>
		</div>

		<!-- Join Existing Room -->
		<div class="bg-white rounded-lg shadow-md p-6">
			<h2 class="text-2xl font-semibold mb-4">Join a Room</h2>
			<div class="flex gap-2">
				<input
					type="text"
					id="roomId"
					placeholder="Enter room ID..."
					class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
				/>
				<button
					id="joinRoom"
					class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition"
				>
					Join
				</button>
			</div>
		</div>
	</div>

	<script>
		// Generate a random room ID
		function generateRoomId(): string {
			return Math.random().toString(36).substring(2, 10);
		}

		// Create new room
		document.getElementById("createRoom")?.addEventListener("click", () => {
			const roomId = generateRoomId();
			window.location.href = `/chatroom/${roomId}`;
		});

		// Join existing room
		document.getElementById("joinRoom")?.addEventListener("click", () => {
			const roomId = (document.getElementById("roomId") as HTMLInputElement).value.trim();
			if (roomId) {
				window.location.href = `/chatroom/${roomId}`;
			} else {
				alert("Please enter a room ID");
			}
		});

		// Allow Enter key to join
		document.getElementById("roomId")?.addEventListener("keypress", (e: KeyboardEvent) => {
			if (e.key === "Enter") {
				document.getElementById("joinRoom")?.click();
			}
		});
	</script>
</PagePlate>
